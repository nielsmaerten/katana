# yaml-language-server: $schema=https://creativeprojects.github.io/resticprofile/jsonschema/config.json
# This file is managed by Ansible. Do not edit manually once it's on the server.
global:
  command-output: auto
  log: /var/log/resticprofile.log
  initialize: true
  restic-arguments-filter: true
groups:
  default:
    - pbs
    - paperless

pbs:
  repository: "rclone:target-pbs:"
  password-file: /root/.restic-password.txt
  sources:
    - /tank/pbs-datastore
    - /etc/pve
    - /etc/network/interfaces
    - /etc/hosts
    - /etc/hostname
    - /etc/resolv.conf
    - /etc/ssh
    - /etc/restic
    - /etc/cron.*

  # Backup options optimized for PBS
  backup:
    dry-run: true
    schedule: "3:00"
    exclude-caches: true
    one-file-system: true
    verbose: 1

  # No long retention needed for PBS datastore,
  # as this is managed by the PBS server itself.
  retain:
    keep-daily: 7
    prune: true

  check:
    schedule: "mon 1:00"
    read-data-subset: "10%"

paperless:
  repository: "rclone:target-paperless:"
  dry-run: true
  sources:
    - /tank/paperless
  schedule: "2:00"

  # Paperless-specific exclusions
  exclude:
    - "*.tmp"
    - "*.lock"
    - "**/cache/**"
    - "**/logs/**"

  # Backup options optimized for Paperless
  backup:
    exclude-caches: true
    one-file-system: true
    verbose: 1

  prune:
    schedule: "sun 4:00" # Weekly prune at 4 AM
    max-unused: "5%"

  retain:
    keep-daily: 30
    keep-weekly: 8
    keep-monthly: 12
    prune: true

  check:
    schedule: "sat" # Weekly check at 3 AM
    read-data-subset: "10%" # Only check 10% of data for faster checks
